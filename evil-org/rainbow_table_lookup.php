<?php

$name_to_pass = [
	"harry" => "f2ac8c609f714f48872f42a0f57837781ea349fc",
	"voldy" => "36d7856f82d03191510035f177170b27d4ed300a",
	"hippogriff" => "57859cf8c15292d0614ec2ce19eaa96229354bab",
	"coolguy666" => "ccb5e9ac048b167fc6da255c6c905b2676ece63f",
	"fawkes" => "f276af2ff8621b9230a8c591b225af90c327a5ca"
];


foreach ($name_to_pass as $name => $hash) {
	$password = queryForPassword($hash);
	echo "{$name} = {$password}\n";
}











function queryForPassword($hash) {
	$db = mysqli_connect("localhost:3306","root","","evil_db");
	$query = "SELECT * FROM rainbow_table WHERE md5='{$hash}' OR sha1='{$hash}'";
	$result = mysqli_query($db, $query);
	$answer = mysqli_fetch_array($result, MYSQLI_ASSOC);
	
	mysqli_free_result($result);

	return $answer['cleartext'];
}
