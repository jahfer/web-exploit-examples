<?php
  if (isset($_GET["username"])) {
    $username = $_GET["username"];
    $db = mysqli_connect("localhost:3306","root","","poptart_db");

    $query = "SELECT id, username FROM users WHERE username='{$username}'";
    $result = mysqli_query($db, $query);

    if (!$result) {
      echo mysqli_error($db);
    } else {
      while($row = mysqli_fetch_array($result, MYSQLI_ASSOC)) {
        $users[] = $row;
      }
    }
  }
?>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Poptart Bank Group</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  </head>
  <body>

    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Find Friends | Poptart Bank Group</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Chequing</a></li>
            <li><a href="#">Savings</a></li>
            <li><a href="#">Invesetment</a></li>
            <li><a href="#">Help</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
  
      <br>
      <? if ($query) : ?>
        <div class="alert alert-warning">
          <strong>SQL Query</strong><br>
          <p>SELECT id, username FROM users WHERE username='<strong class="alert-danger"><?= $username ?></strong>'</p>
        </div>
      <? endif; ?>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Find Friends</h3>
        </div>
        <div class="panel-body">

          <form action="ex02.php" type="GET">
            <div class="input-group">
              <input type="text" class="form-control" name="username" placeholder="Enter username">
              <span class="input-group-btn">
                <input type="submit" value="Search" class="btn btn-default">
              </span>
            </div>
          </form>

          <br>
          
          <? if (count($users) > 0) : ?>
            <ul class="list-group">
              <? foreach ($users as $user) : ?>
                <li class="list-group-item"><?= $user['username'] ?></li>
              <? endforeach; ?>
            </ul>
          <? endif; ?>

        </div>
      </div>
    </div>
  </body>
</html>