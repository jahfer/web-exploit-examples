<?php
  if (isset($_GET["username"])) {
    $username = $_GET["username"];
    $db = mysqli_connect("localhost:3306","root","","poptart_db");

    $query = "SELECT id, username FROM users WHERE username='{$username}'";
    $result = mysqli_query($db, $query);

    if (!$result) {
      die(mysqli_error($db));
    }

    while($row = mysqli_fetch_array($result, MYSQLI_ASSOC)) {
      $users[] = $row;
    }
  }
?>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Very Secure Site</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  </head>
  <body>
    <div class="container">

      <h1>The Poptart Company</h1>
      <br>
      <div class="alert alert-warning">
        <strong>SQL Query</strong><br>
        <?= $query ?>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Find Friends</h3>
        </div>
        <div class="panel-body">

          <form action="ex02.php" type="GET">
            <div class="input-group">
              <input type="text" class="form-control" name="username" placeholder="Enter username">
              <span class="input-group-btn">
                <input type="submit" value="Search" class="btn btn-default">
              </span>
            </div>
          </form>

          <br>
          
          <? if (count($users) > 0) : ?>
            <ul class="list-group">
              <? foreach ($users as $user) : ?>
                <li class="list-group-item"><?= $user['username'] ?></li>
              <? endforeach; ?>
            </ul>
          <? endif; ?>

        </div>
      </div>
    </div>
  </body>
</html>